<!--ç›¸æœºè®¾å¤‡è¯¦æƒ…é¡µé¢-->
<view class="camera-detail-page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <view class="nav-left" bindtap="goBack">
      <text class="nav-icon">â†</text>
    </view>
    <text class="nav-title">è®¾å¤‡è¯¦æƒ…</text>
    <view class="nav-right">
      <view class="nav-btn" bindtap="onShareTap">
        <text class="nav-icon">ğŸ“¤</text>
      </view>
      <view class="nav-btn" bindtap="onFavoriteTap">
        <text class="nav-icon">{{cameraDetail.isFavorited ? 'â¤ï¸' : 'ğŸ¤'}}</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <t-loading theme="circular" size="60rpx" />
    <text class="loading-text">åŠ è½½è®¾å¤‡è¯¦æƒ…ä¸­...</text>
  </view>

  <!-- è®¾å¤‡è¯¦æƒ…å†…å®¹ -->
  <scroll-view class="content-scroll" scroll-y="true" wx:if="{{!loading && cameraDetail}}">
    <!-- è®¾å¤‡å›¾ç‰‡å±•ç¤º -->
    <view class="camera-images">
      <swiper
        class="images-swiper"
        indicator-dots="{{cameraDetail.images && cameraDetail.images.length > 1}}"
        indicator-color="rgba(255,255,255,0.3)"
        indicator-active-color="rgba(212,175,55,0.8)"
        circular="{{true}}"
      >
        <swiper-item wx:for="{{cameraDetail.images || [cameraDetail.image]}}" wx:key="*this">
          <image
            class="camera-image"
            src="{{item}}"
            mode="aspectFill"
            bindtap="onImagePreview"
            data-index="{{index}}"
          />
        </swiper-item>
      </swiper>
    </view>

    <!-- è®¾å¤‡åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
    <view class="info-card main-info">
      <!-- å–å®¶/å•†å®¶ä¿¡æ¯ -->
      <view class="seller-section">
        <view class="seller-info" bindtap="onSellerTap">
          <image class="seller-avatar" src="{{cameraDetail.sellerAvatar}}" mode="aspectFill" />
          <view class="seller-details">
            <text class="seller-name">{{cameraDetail.seller || cameraDetail.shop}}</text>
            <view class="seller-meta">
              <text class="seller-rating">â­ {{cameraDetail.sellerRating || cameraDetail.shopRating}}</text>
              <text class="seller-location">{{cameraDetail.location}}</text>
            </view>
          </view>
        </view>
        <view class="seller-actions">
          <view class="contact-btn" bindtap="onContactTap">
            <text class="contact-text">è”ç³»{{cameraDetail.type === 'rental' ? 'å•†å®¶' : 'å–å®¶'}}</text>
          </view>
        </view>
      </view>

      <!-- è®¾å¤‡æ ‡é¢˜å’Œä»·æ ¼ -->
      <view class="camera-content">
        <text class="camera-title">{{cameraDetail.name}}</text>
        <view class="price-section">
          <text class="current-price">Â¥{{cameraDetail.price}}</text>
          <text class="price-unit" wx:if="{{cameraDetail.type === 'rental'}}">/å¤©</text>
          <text class="original-price" wx:if="{{cameraDetail.originalPrice}}">Â¥{{cameraDetail.originalPrice}}</text>
        </view>
        
        <!-- æŠ¼é‡‘ä¿¡æ¯ï¼ˆç§Ÿèµï¼‰ -->
        <view class="deposit-info" wx:if="{{cameraDetail.type === 'rental'}}">
          <text class="deposit-label">æŠ¼é‡‘ï¼š</text>
          <text class="deposit-amount">Â¥{{cameraDetail.deposit}}</text>
        </view>

        <!-- è®¾å¤‡æ ‡ç­¾ -->
        <view class="camera-tags" wx:if="{{cameraDetail.tags && cameraDetail.tags.length > 0}}">
          <text class="tag-item" wx:for="{{cameraDetail.tags}}" wx:key="*this">
            {{item}}
          </text>
        </view>
      </view>
    </view>

    <!-- è®¾å¤‡å‚æ•°å¡ç‰‡ -->
    <view class="info-card specs-info">
      <view class="card-header">
        <text class="card-title">ğŸ“· è®¾å¤‡å‚æ•°</text>
      </view>
      <view class="specs-grid">
        <view class="spec-item" wx:for="{{cameraDetail.features}}" wx:key="*this">
          <text class="spec-value">{{item}}</text>
        </view>
      </view>
    </view>

    <!-- è®¾å¤‡æè¿°å¡ç‰‡ -->
    <view class="info-card description-info" wx:if="{{cameraDetail.description}}">
      <view class="card-header">
        <text class="card-title">ğŸ“ è®¾å¤‡æè¿°</text>
      </view>
      <view class="description-content">
        <text class="description-text">{{cameraDetail.description}}</text>
      </view>
    </view>

    <!-- ç§Ÿèµä¿¡æ¯å¡ç‰‡ï¼ˆä»…ç§Ÿèµæ˜¾ç¤ºï¼‰ -->
    <view class="info-card rental-info" wx:if="{{cameraDetail.type === 'rental'}}">
      <view class="card-header">
        <text class="card-title">ğŸª ç§Ÿèµä¿¡æ¯</text>
      </view>
      <view class="rental-details">
        <view class="rental-item">
          <text class="rental-label">ç§Ÿèµå‘¨æœŸ</text>
          <text class="rental-value">{{cameraDetail.rentalPeriod}}</text>
        </view>
        <view class="rental-item">
          <text class="rental-label">å·²ç§Ÿæ¬¡æ•°</text>
          <text class="rental-value">{{cameraDetail.rentCount}}æ¬¡</text>
        </view>
        <view class="rental-item" wx:if="{{cameraDetail.availableDates}}">
          <text class="rental-label">å¯ç§Ÿæ—¶é—´</text>
          <text class="rental-value">{{cameraDetail.availableDates}}</text>
        </view>
      </view>
    </view>

    <!-- äº¤æ˜“ä¿¡æ¯å¡ç‰‡ï¼ˆä»…ä¹°å–æ˜¾ç¤ºï¼‰ -->
    <view class="info-card trade-info" wx:if="{{cameraDetail.type !== 'rental'}}">
      <view class="card-header">
        <text class="card-title">ğŸ’° äº¤æ˜“ä¿¡æ¯</text>
      </view>
      <view class="trade-details">
        <view class="trade-item">
          <text class="trade-label">æˆè‰²</text>
          <text class="trade-value">{{cameraDetail.condition}}</text>
        </view>
        <view class="trade-item" wx:if="{{cameraDetail.purchaseDate}}">
          <text class="trade-label">è´­ä¹°æ—¶é—´</text>
          <text class="trade-value">{{cameraDetail.purchaseDate}}</text>
        </view>
        <view class="trade-item" wx:if="{{cameraDetail.warranty}}">
          <text class="trade-label">ä¿ä¿®æƒ…å†µ</text>
          <text class="trade-value">{{cameraDetail.warranty}}</text>
        </view>
      </view>
    </view>

    <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
    <view class="safe-area-bottom"></view>
  </scroll-view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions" wx:if="{{!loading && cameraDetail}}">
    <view class="action-left">
      <view class="action-item" bindtap="onLikeTap">
        <text class="action-icon {{cameraDetail.isLiked ? 'liked' : ''}}">{{cameraDetail.isLiked ? 'â¤ï¸' : 'ğŸ¤'}}</text>
        <text class="action-count">{{cameraDetail.likeCount || 0}}</text>
      </view>
      <view class="action-item" bindtap="onCollectTap">
        <text class="action-icon {{cameraDetail.isCollected ? 'collected' : ''}}">{{cameraDetail.isCollected ? 'â­' : 'â˜†'}}</text>
        <text class="action-count">æ”¶è—</text>
      </view>
    </view>
    <view class="action-right">
      <view class="purchase-btn" bindtap="onPurchaseTap">
        <text class="purchase-text">
          {{cameraDetail.type === 'rental' ? 'ç«‹å³ç§Ÿèµ' : 'ç«‹å³è´­ä¹°'}}
        </text>
      </view>
    </view>
  </view>
</view>
