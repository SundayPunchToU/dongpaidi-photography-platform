<!--çº¦æ‹è¯¦æƒ…é¡µé¢-->
<view class="appointment-detail-page">
  <!-- è‡ªå®šä¹‰å¯¼èˆªæ  -->
  <view class="custom-navbar">
    <view class="nav-left" bindtap="goBack">
      <text class="nav-icon">â†</text>
    </view>
    <text class="nav-title">çº¦æ‹è¯¦æƒ…</text>
    <view class="nav-right">
      <view class="nav-btn" bindtap="onShareTap">
        <text class="nav-icon">ğŸ“¤</text>
      </view>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-container">
    <t-loading theme="circular" size="60rpx" />
    <text class="loading-text">åŠ è½½çº¦æ‹è¯¦æƒ…ä¸­...</text>
  </view>

  <!-- çº¦æ‹è¯¦æƒ…å†…å®¹ -->
  <scroll-view class="content-scroll" scroll-y="true" wx:if="{{!loading && appointmentDetail}}">
    <!-- çº¦æ‹ä¸»å›¾ -->
    <view class="appointment-images" wx:if="{{appointmentDetail.images && appointmentDetail.images.length > 0}}">
      <swiper
        class="images-swiper"
        indicator-dots="{{appointmentDetail.images.length > 1}}"
        indicator-color="rgba(255,255,255,0.3)"
        indicator-active-color="rgba(212,175,55,0.8)"
        circular="{{true}}"
      >
        <swiper-item wx:for="{{appointmentDetail.images}}" wx:key="*this">
          <image
            class="appointment-image"
            src="{{item}}"
            mode="aspectFill"
            bindtap="onImagePreview"
            data-index="{{index}}"
          />
        </swiper-item>
      </swiper>
    </view>

    <!-- çº¦æ‹åŸºæœ¬ä¿¡æ¯å¡ç‰‡ -->
    <view class="info-card main-info">
      <!-- å‘å¸ƒè€…ä¿¡æ¯ -->
      <view class="publisher-section">
        <view class="publisher-info" bindtap="onPublisherTap">
          <image class="publisher-avatar" src="{{appointmentDetail.publisherAvatar}}" mode="aspectFill" />
          <view class="publisher-details">
            <text class="publisher-name">{{appointmentDetail.publisherName}}</text>
            <view class="publisher-meta">
              <text class="publisher-type">{{appointmentDetail.type === 'photographer_seek_model' ? 'æ‘„å½±å¸ˆ' : 'æ¨¡ç‰¹'}}</text>
              <text class="publish-time">{{appointmentDetail.publishTime}}</text>
            </view>
          </view>
        </view>
        <view class="publisher-actions">
          <view class="contact-btn" bindtap="onContactTap">
            <text class="contact-text">è”ç³»TA</text>
          </view>
        </view>
      </view>

      <!-- çº¦æ‹æ ‡é¢˜å’Œæè¿° -->
      <view class="appointment-content">
        <text class="appointment-title">{{appointmentDetail.title}}</text>
        <text class="appointment-description">{{appointmentDetail.description}}</text>

        <!-- çº¦æ‹æ ‡ç­¾ -->
        <view class="appointment-tags" wx:if="{{appointmentDetail.tags && appointmentDetail.tags.length > 0}}">
          <text class="tag-item" wx:for="{{appointmentDetail.tags}}" wx:key="*this">
            #{{item}}
          </text>
        </view>
      </view>
    </view>

    <!-- çº¦æ‹è¯¦ç»†ä¿¡æ¯å¡ç‰‡ -->
    <view class="info-card detail-info">
      <view class="card-header">
        <text class="card-title">ğŸ“‹ çº¦æ‹è¯¦æƒ…</text>
      </view>
      <view class="detail-grid">
        <!-- æ‹æ‘„æ—¶é—´ -->
        <view class="detail-item" wx:if="{{appointmentDetail.shootingTime}}">
          <text class="detail-label">æ‹æ‘„æ—¶é—´</text>
          <text class="detail-value">{{appointmentDetail.shootingTime}}</text>
        </view>

        <!-- æ‹æ‘„åœ°ç‚¹ -->
        <view class="detail-item" wx:if="{{appointmentDetail.location}}">
          <text class="detail-label">æ‹æ‘„åœ°ç‚¹</text>
          <text class="detail-value">{{appointmentDetail.location}}</text>
        </view>

        <!-- é¢„ç®—èŒƒå›´ -->
        <view class="detail-item" wx:if="{{appointmentDetail.budget}}">
          <text class="detail-label">é¢„ç®—èŒƒå›´</text>
          <text class="detail-value">{{appointmentDetail.budget}}</text>
        </view>

        <!-- æ‹æ‘„é£æ ¼ -->
        <view class="detail-item" wx:if="{{appointmentDetail.style}}">
          <text class="detail-label">æ‹æ‘„é£æ ¼</text>
          <text class="detail-value">{{appointmentDetail.style}}</text>
        </view>

        <!-- çº¦æ‹çŠ¶æ€ -->
        <view class="detail-item">
          <text class="detail-label">çº¦æ‹çŠ¶æ€</text>
          <view class="status-badge {{appointmentDetail.status}}">
            <text class="status-text">
              {{appointmentDetail.status === 'open' ? 'æ‹›å‹Ÿä¸­' :
                appointmentDetail.status === 'in_progress' ? 'è¿›è¡Œä¸­' :
                appointmentDetail.status === 'completed' ? 'å·²å®Œæˆ' : 'å·²å…³é—­'}}
            </text>
          </view>
        </view>
      </view>
    </view>

    <!-- è¦æ±‚è¯´æ˜å¡ç‰‡ -->
    <view class="info-card requirements-info" wx:if="{{appointmentDetail.requirements}}">
      <view class="card-header">
        <text class="card-title">ğŸ“ è¦æ±‚è¯´æ˜</text>
      </view>
      <view class="requirements-content">
        <text class="requirements-text">{{appointmentDetail.requirements}}</text>
      </view>
    </view>

    <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
    <view class="safe-area-bottom"></view>
  </scroll-view>

  <!-- åº•éƒ¨æ“ä½œæ  -->
  <view class="bottom-actions" wx:if="{{!loading && appointmentDetail}}">
    <view class="action-left">
      <view class="action-item" bindtap="onLikeTap">
        <text class="action-icon {{appointmentDetail.isLiked ? 'liked' : ''}}">{{appointmentDetail.isLiked ? 'â¤ï¸' : 'ğŸ¤'}}</text>
        <text class="action-count">{{appointmentDetail.likeCount || 0}}</text>
      </view>
      <view class="action-item" bindtap="onCollectTap">
        <text class="action-icon {{appointmentDetail.isCollected ? 'collected' : ''}}">{{appointmentDetail.isCollected ? 'â­' : 'â˜†'}}</text>
        <text class="action-count">{{appointmentDetail.collectCount || 0}}</text>
      </view>
    </view>
    <view class="action-right">
      <view class="apply-btn {{appointmentDetail.status !== 'open' ? 'disabled' : ''}}" bindtap="onApplyTap">
        <text class="apply-text">
          {{appointmentDetail.status === 'open' ? 'ç«‹å³ç”³è¯·' :
            appointmentDetail.status === 'in_progress' ? 'è¿›è¡Œä¸­' :
            appointmentDetail.status === 'completed' ? 'å·²å®Œæˆ' : 'å·²å…³é—­'}}
        </text>
      </view>
    </view>
  </view>
</view>
