<t-navbar left-arrow />
<view class="page login">
  <view class="login__title"> 欢迎登录 TDsign </view>
  <view class="login__content">
    <view class="login__input">
      <view class="login__password" wx:if="{{isPasswordLogin}}">
        <t-input
          label="账号"
          placeholder="请输入手机号/邮箱"
          value="{{passwordInfo.account}}"
          bindchange="onAccountChange"
        ></t-input>
        <t-input
          label="密码"
          placeholder="请输入密码"
          type="password"
          clearable
          value="{{passwordInfo.password}}"
          bindchange="onPasswordChange"
        />
      </view>

      <t-input wx:else value="{{phoneNumber}}" placeholder="请输入手机号" type="number" bindchange="onPhoneInput">
        <view slot="label" class="input-label">
          <text>+86</text>
          <t-icon name="caret-down-small" size="40rpx" class="input-iconl"></t-icon>
        </view>
      </t-input>
    </view>

    <view class="login__tips">未注册的手机号验证通过后将自动注册</view>

    <t-radio-group allow-uncheck borderless value="{{radioValue}}" bind:change="onCheckChange">
      <t-radio
        label="同意《协议条款》"
        value="agree"
        t-class="radio-class"
        t-class-icon="radio-class-icon"
        t-class-label="radio-class-label"
      />
    </t-radio-group>

    <view class="login__button">
      <t-button theme="primary" size="large" block disabled="{{!isSubmit}}" bindtap="login">
        {{ isPasswordLogin ? '登录' : '验证并登录' }}
      </t-button>
    </view>

    <view class="login__password--forget" wx:if="{{isPasswordLogin}}">
      <text>忘记密码？</text>
      <t-link theme="primary" size="small">找回密码</t-link>
    </view>

    <!-- 多平台登录选项 -->
    <view class="login__multi-platform" wx:if="{{showMultiPlatformOption}}">
      <view class="divider">
        <text>或</text>
      </view>

      <t-button
        theme="default"
        size="large"
        block
        bindtap="onGoToMultiPlatformLogin"
        t-class="multi-platform-btn"
      >
        使用手机号登录
      </t-button>
    </view>

    <!-- 微信登录选项（仅微信小程序） -->
    <view class="login__wechat" wx:if="{{platformInfo.isWechatMiniProgram}}">
      <view class="divider">
        <text>或</text>
      </view>

      <t-button
        theme="primary"
        size="large"
        block
        bindtap="onWechatLogin"
        t-class="wechat-login-btn"
      >
        <t-icon name="logo-wechat" size="40rpx" color="#fff"></t-icon>
        <text>微信快速登录</text>
      </t-button>
    </view>
  </view>

  <!-- 开发环境测试入口 -->
  <view class="login__test-entry" wx:if="{{showTestEntry}}">
    <view class="divider">
      <text>开发测试</text>
    </view>

    <t-button
      theme="default"
      size="medium"
      variant="text"
      bindtap="onGoToTestLogin"
      t-class="test-entry-btn"
    >
      🧪 多平台登录测试
    </t-button>
  </view>

  <view class="login__others">
    <text class="login__others-label">其他方式</text>
    <view class="login__others-buttons">
      <t-button class="button" variant="outline" theme="default" size="medium" shape="round" bindtap="changeLogin">
        {{isPasswordLogin ? '验证码登录' : '密码登录' }}
      </t-button>
      <t-button
        class="button"
        variant="outline"
        theme="default"
        size="medium"
        icon="logo-wechat-stroke"
        shape="circle"
      ></t-button>
      <t-button class="button" variant="outline" theme="default" size="medium" icon="logo-qq" shape="circle"></t-button>
      <t-button
        class="button"
        variant="outline"
        theme="default"
        size="medium"
        icon="logo-wecom"
        shape="circle"
      ></t-button>
    </view>
  </view>
</view>
